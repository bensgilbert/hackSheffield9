import"../chunks/entry.BTiESpIL.js";import{o as ee,_ as te,b as A}from"../chunks/preload-helper.BU0XxFM2.js";import{t as B,a as C}from"../chunks/disclose-version.DqJhXajo.js";import"../chunks/legacy.C7OPbul6.js";import{p as oe,g as o,ai as g,an as L,q as m,j as n,s as i,k as ae,l,am as G}from"../chunks/runtime.BWfRYliX.js";import{e as O,c as re}from"../chunks/events.CHO8LOBA.js";import{s as se,e as ie,i as ne}from"../chunks/map.ByqD-lcE.js";import{b,r as T}from"../chunks/input.wJnTXmY3.js";import{i as le}from"../chunks/lifecycle.DxgCNWoR.js";function de(u){return function(...v){var p=v[0];return p.preventDefault(),u==null?void 0:u.apply(this,v)}}const xe=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));var ce=B('<div class="mt-2 flex items-center space-x-2"><input type="text" placeholder="Item name" required class="w-2/3 rounded-md border-gray-300 p-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"> <input type="number" placeholder="Quantity" min="1" required class="w-1/3 rounded-md border-gray-300 p-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"> <button type="button" class="text-red-500 hover:text-red-700">Remove</button></div>'),me=B('<div class="container relative mx-auto p-4"><div class="absolute left-1/2 top-4 z-10 w-4/5 -translate-x-1/2 transform"><input type="text" placeholder="Search for a location" class="w-full rounded-md border-gray-300 p-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"></div> <div class="relative"><div class="h-[400px] w-full rounded-md bg-gray-300"></div> <div class="absolute left-1/2 top-1/2 z-20 -translate-x-1/2 -translate-y-1/2 transform" style="pointer-events: none"><img src="/location-icon.png" alt="Map Pin" class="h-5 w-5"></div></div> <div class="mt-4"><form class="space-y-4"><div><label for="message" class="block text-sm font-medium text-gray-700">Message</label> <textarea id="message" required class="mt-1 w-full rounded-md border-gray-300 p-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="Enter a message"></textarea></div> <div><label for="time" class="block text-sm font-medium text-gray-700">Delivery Time</label> <input type="time" id="time" required class="mt-1 w-full rounded-md border-gray-300 p-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"></div> <div><label for="items" class="block text-sm font-medium text-gray-700">Items</label> <!> <button type="button" class="mt-2 text-indigo-500 hover:text-indigo-700">Add Item</button></div> <button type="submit" class="mt-4 w-full rounded-md bg-indigo-600 px-4 py-2 font-medium text-white hover:bg-indigo-700">Submit Request</button></form></div></div>');function we(u,v){oe(v,!1);let p=g(),f,d=g(),c={lat:13.736717,lng:100.523186},y=!1;ee(async()=>{J();try{const e=await fetch("http://localhost:3000/check-order");e.ok?(await e.json()).exists&&(window.location.href="/viewrequest"):console.error("Failed to check order existence")}catch(e){console.error("Error checking order:",e)}});async function J(){const e=await te(()=>import("../chunks/index.B1X_Juiv.js"),[],import.meta.url),{Loader:a}=e,t=new a({apiKey:"AIzaSyDB8EtJ3vK8gwJgTgjeNyvDLkUOYnal1GM",version:"weekly",libraries:["places","maps"]});try{await t.load(),K()}catch(s){console.error("Error loading Google Maps",s)}}function K(){const e=window.google,a={center:c,zoom:12,disableDefaultUI:!0,gestureHandling:"greedy",styles:se};f=new e.maps.Map(o(p),a),N(e),f.addListener("idle",()=>{if(!y){const t=f.getCenter();c={lat:t.lat(),lng:t.lng()},F(e)}})}function N(e){const a=new e.maps.places.Autocomplete(o(d),{types:["geocode"],componentRestrictions:{country:"uk"}});a.addListener("place_changed",()=>{const t=a.getPlace();if(t.geometry&&t.geometry.location){y=!0;const s=t.geometry.location;f.setCenter(s),c={lat:s.lat(),lng:s.lng()},y=!1}else alert("No location details available for the selected place.")})}function F(e){new e.maps.Geocoder().geocode({location:c},(t,s)=>{s==="OK"&&t[0]?L(d,o(d).value=t[0].formatted_address):console.error("Error finding address: ",s)})}let h=g(""),r=g([{name:"",quantity:1}]),_=g("");function U(){m(r,[...o(r),{name:"",quantity:1}])}function H(e){m(r,o(r).filter((a,t)=>t!==e))}async function Q(){const e={message:o(_),lat:c.lat,lng:c.lng,address:o(d).value,collectionTime:V(o(h)),items:o(r)};try{(await fetch("/create-request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?alert("Request submitted successfully!"):console.error("Failed to submit request")}catch(a){console.error("Error submitting request: ",a)}}function V(e){const[a,t]=e.split(":");return`${a}${t}`}le();var x=me(),w=n(x),Y=n(w);A(Y,e=>m(d,e),()=>o(d)),l(w);var q=i(w,2),W=n(q);A(W,e=>m(p,e),()=>o(p)),G(2),l(q);var j=i(q,2),k=n(j),E=n(k),P=i(n(E),2);re(P),l(E);var I=i(E,2),R=i(n(I),2);T(R),l(I);var z=i(I,2),$=i(n(z),2);ie($,1,()=>o(r),ne,(e,a,t)=>{var s=ce(),M=n(s);T(M);var S=i(M,2);T(S);var Z=i(S,2);l(s),b(M,()=>o(r)[t].name,D=>L(r,o(r)[t].name=D)),b(S,()=>o(r)[t].quantity,D=>L(r,o(r)[t].quantity=D)),O("click",Z,()=>H(t)),C(e,s)});var X=i($,2);l(z),G(2),l(k),l(j),l(x),b(P,()=>o(_),e=>m(_,e)),b(R,()=>o(h),e=>m(h,e)),O("click",X,U),O("submit",k,de(Q)),C(u,x),ae()}export{we as component,xe as universal};
