import{g as ee}from"../chunks/entry.CGzROe4q.js";import{o as te,_ as ae,b as z}from"../chunks/preload-helper.DL3Oyumf.js";import{t as C,a as $}from"../chunks/disclose-version.BREFLA4z.js";import"../chunks/legacy.DzUqpfFO.js";import{p as oe,g as a,a2 as u,a3 as S,q as c,j as n,s as i,k as se,l,a4 as A}from"../chunks/runtime.Ct9RiEw0.js";import{e as L,b as re}from"../chunks/events.DKTRiInL.js";import{s as ie,e as ne,b as g,i as le,r as O}from"../chunks/map.OXyISxBQ.js";import{p as de}from"../chunks/event-modifiers.CWmzcjye.js";import{i as me}from"../chunks/lifecycle.CFcoRRZz.js";function ce(){ee("/viewrequest")}const qe=Object.freeze(Object.defineProperty({__proto__:null,load:ce},Symbol.toStringTag,{value:"Module"}));var ue=C('<div class="mt-2 flex items-center space-x-2"><input type="text" placeholder="Item name" required class="w-2/3 rounded-md border-gray-300 p-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"> <input type="number" placeholder="Quantity" min="1" required class="w-1/3 rounded-md border-gray-300 p-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"> <button type="button" class="text-red-500 hover:text-red-700">Remove</button></div>'),pe=C('<div class="container relative mx-auto p-4"><div class="absolute left-1/2 top-4 z-10 w-4/5 -translate-x-1/2 transform"><input type="text" placeholder="Search for a location" class="w-full rounded-md border-gray-300 p-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"></div> <div class="relative"><div class="h-[400px] w-full rounded-md bg-gray-300"></div> <div class="absolute left-1/2 top-1/2 z-20 -translate-x-1/2 -translate-y-1/2 transform" style="pointer-events: none"><img src="/location-icon.png" alt="Map Pin" class="h-5 w-5"></div></div> <div class="mt-4"><form class="space-y-4"><div><label for="message" class="block text-sm font-medium text-gray-700">Message</label> <textarea id="message" required class="mt-1 w-full rounded-md border-gray-300 p-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="Enter a message"></textarea></div> <div><label for="time" class="block text-sm font-medium text-gray-700">Delivery Time</label> <input type="time" id="time" required class="mt-1 w-full rounded-md border-gray-300 p-2 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"></div> <div><label for="items" class="block text-sm font-medium text-gray-700">Items</label> <!> <button type="button" class="mt-2 text-indigo-500 hover:text-indigo-700">Add Item</button></div> <button type="submit" class="mt-4 w-full rounded-md bg-indigo-600 px-4 py-2 font-medium text-white hover:bg-indigo-700">Submit Request</button></form></div></div>');function ke(G,B){oe(B,!1);let v=u(),p,d=u(),m={lat:13.736717,lng:100.523186},f=!1;te(()=>{J()});async function J(){const e=await ae(()=>import("../chunks/index.B1X_Juiv.js"),[],import.meta.url),{Loader:o}=e,t=new o({apiKey:"AIzaSyDB8EtJ3vK8gwJgTgjeNyvDLkUOYnal1GM",version:"weekly",libraries:["places","maps"]});try{await t.load(),K()}catch(r){console.error("Error loading Google Maps",r)}}function K(){const e=window.google,o={center:m,zoom:12,disableDefaultUI:!0,gestureHandling:"greedy",styles:ie};p=new e.maps.Map(a(v),o),N(e),p.addListener("idle",()=>{if(!f){const t=p.getCenter();m={lat:t.lat(),lng:t.lng()},U(e)}})}function N(e){const o=new e.maps.places.Autocomplete(a(d),{types:["geocode"],componentRestrictions:{country:"uk"}});o.addListener("place_changed",()=>{const t=o.getPlace();if(t.geometry&&t.geometry.location){f=!0;const r=t.geometry.location;p.setCenter(r),m={lat:r.lat(),lng:r.lng()},f=!1}else alert("No location details available for the selected place.")})}function U(e){new e.maps.Geocoder().geocode({location:m},(t,r)=>{r==="OK"&&t[0]?S(d,a(d).value=t[0].formatted_address):console.error("Error finding address: ",r)})}let b=u(""),s=u([{name:"",quantity:1}]),y=u("");function F(){c(s,[...a(s),{name:"",quantity:1}])}function H(e){c(s,a(s).filter((o,t)=>t!==e))}async function Q(){const e={message:a(y),lat:m.lat,lng:m.lng,address:a(d).value,collectionTime:V(a(b)),items:a(s)};try{(await fetch("/create-request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?alert("Request submitted successfully!"):console.error("Failed to submit request")}catch(o){console.error("Error submitting request: ",o)}}function V(e){const[o,t]=e.split(":");return`${o}${t}`}me();var _=pe(),h=n(_),Y=n(h);z(Y,e=>c(d,e),()=>a(d)),l(h);var x=i(h,2),W=n(x);z(W,e=>c(v,e),()=>a(v)),A(2),l(x);var T=i(x,2),w=n(T),q=n(w),D=i(n(q),2);re(D),l(q);var k=i(q,2),P=i(n(k),2);O(P),l(k);var R=i(k,2),j=i(n(R),2);ne(j,1,()=>a(s),le,(e,o,t)=>{var r=ue(),E=n(r);O(E);var I=i(E,2);O(I);var Z=i(I,2);l(r),g(E,()=>a(s)[t].name,M=>S(s,a(s)[t].name=M)),g(I,()=>a(s)[t].quantity,M=>S(s,a(s)[t].quantity=M)),L("click",Z,()=>H(t)),$(e,r)});var X=i(j,2);l(R),A(2),l(w),l(T),l(_),g(D,()=>a(y),e=>c(y,e)),g(P,()=>a(b),e=>c(b,e)),L("click",X,F),L("submit",w,de(Q)),$(G,_),se()}export{ke as component,qe as universal};
